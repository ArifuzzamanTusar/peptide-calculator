<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peptide Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* --- CSS Variables for Easy Theming --- */
        :root {
            --primary-purple: #6c5ce7;
            --primary-blue: #3498db;
            --light-blue-bg: #eaf5fc;
            --border-color: #dfe6e9;
            --text-dark: #2d3436;
            --text-light: #636e72;
            --background-color: #f7f8fa;
            --container-bg: #ffffff;
            --font-family: 'Inter', sans-serif;
        }

        /* --- Basic Setup --- */
        body {
            font-family: var(--font-family);
            background-color: var(--background-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            color: var(--text-dark);
            margin: 0;
            padding: 24px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* --- Calculator Container --- */
        .peptide-calculator {
            background-color: var(--container-bg);
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.07);
            width: 100%;
            max-width: 800px; /* Slightly wider for better spacing */
            padding: 40px 50px;
            box-sizing: border-box;
        }

        /* --- Header --- */
        .calculator-header {
            text-align: center;
            margin-bottom: 40px;
        }
        .calculator-header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-purple);
            margin: 0;
            letter-spacing: 0.5px;
        }
        .calculator-header .divider {
            width: 50px;
            height: 3px;
            background-color: var(--border-color);
            margin: 12px auto 0;
            border-radius: 2px;
        }

        /* --- Form Styling --- */
        #peptideForm {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2-column layout */
            gap: 35px 40px; /* row-gap column-gap */
            margin-bottom: 35px;
        }

        .form-group {
            border: none;
            padding: 0;
            margin: 0;
        }
        
        .form-group.full-width {
            grid-column: 1 / -1; /* Make an item span both columns */
        }
        
        .form-group legend {
            font-size: 1.05rem;
            font-weight: 600;
            margin-bottom: 15px;
            padding: 0;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        legend img.icon {
            height: 28px;
        }

        .option-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        /* --- Radio Button Styling (to look like buttons) --- */
        .option-group input[type="radio"] {
            display: none;
        }

        .option-group label {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.95rem;
            transition: all 0.2s ease-in-out;
            background-color: #fdfdfd;
            user-select: none;
        }
        
        .option-group label:hover {
            border-color: var(--primary-blue);
            color: var(--primary-blue);
        }
        
        .syringe-option img {
            height: 24px;
        }

        /* --- Selected State --- */
        .option-group input[type="radio"]:checked + label {
            background-color: var(--light-blue-bg);
            border-color: var(--primary-blue);
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* --- "Other" Input Field --- */
        .other-input-wrapper {
            display: flex;
            align-items: center;
        }
        .other-input-wrapper label {
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            border-right: none;
        }
        .other-input-wrapper input[type="radio"]:checked + label {
            border-right: none;
        }

        .other-input {
            width: 80px;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-left: 1px solid var(--border-color);
            border-radius: 10px;
            border-top-left-radius: 0;
            border-bottom-left-radius: 0;
            font-size: 0.95rem;
            transition: all 0.2s ease-in-out;
        }
        .other-input:focus {
            outline: none;
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px var(--light-blue-bg);
        }
        .other-input:disabled {
            background-color: #f5f5f5;
            cursor: not-allowed;
        }

        /* --- Result Area --- */
        .calculator-result {
            background-color: #f9fafb;
            border-radius: 16px;
            padding: 25px 30px;
        }

        .result-text {
            font-size: 1.2rem;
            color: var(--text-light);
            font-weight: 500;
            text-align: center;
            margin-bottom: 25px;
        }
        .result-text span {
            color: var(--primary-blue);
            font-weight: 700;
        }

        /* --- Ruler Visual --- */
        .ruler {
            position: relative;
            width: 100%;
            height: 8px; /* Thinner ruler */
            background-color: #e4e8eb;
            border-radius: 4px;
        }

        .ruler-progress {
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 0; /* JS will set this */
            background: var(--primary-blue);
            border-radius: 4px;
            transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .ruler-ticks {
            position: relative;
            top: 5px; /* Move ticks closer */
            display: flex;
            justify-content: space-between;
            color: var(--text-light);
            font-size: 0.8rem;
            padding: 0 1px; /* Align ticks with ruler edges */
        }
        .ruler-ticks span {
            position: relative;
            display: inline-block;
            padding-top: 10px; /* More space for the tick line */
        }
        .ruler-ticks span::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 8px;
            background-color: #c8d1d8;
        }
        .ruler-ticks span:first-child {
            visibility: hidden; /* Hide the '0' label */
        }
        
        /* --- Responsive Adjustments --- */
        @media (max-width: 768px) {
            #peptideForm {
                grid-template-columns: 1fr; /* Stack to a single column on smaller screens */
                gap: 30px;
            }
            .peptide-calculator {
                padding: 30px;
            }
        }
    </style>
</head>
<body>

    <div class="peptide-calculator">
        <div class="calculator-header">
            <h1>PEPTIDE CALCULATOR</h1>
            <div class="divider"></div>
        </div>

        <form id="peptideForm">
            <fieldset class="form-group full-width">
                <legend>What is the total volume of your syringe?</legend>
                <div class="option-group">
                    <input type="radio" id="syringe_03" name="syringe_volume" value="0.3" checked>
                    <label for="syringe_03" class="syringe-option">
                        <img src="https://i.imgur.com/39aXfGq.png" alt="0.3ml syringe"> 0.3 ml
                    </label>
                    
                    <input type="radio" id="syringe_05" name="syringe_volume" value="0.5">
                    <label for="syringe_05" class="syringe-option">
                        <img src="https://i.imgur.com/B9B1Asw.png" alt="0.5ml syringe"> 0.5 ml
                    </label>

                    <input type="radio" id="syringe_10" name="syringe_volume" value="1.0">
                    <label for="syringe_10" class="syringe-option">
                        <img src="https://i.imgur.com/sC0bZ0F.png" alt="1.0ml syringe"> 1.0 ml
                    </label>
                </div>
            </fieldset>

            <fieldset class="form-group">
                <legend>
                    <img src="https://i.imgur.com/Jd1W5uH.png" alt="vial icon" class="icon">
                    Select Peptide Vial Quantity
                </legend>
                <div class="option-group">
                    <input type="radio" id="vial_5" name="vial_quantity" value="5" checked>
                    <label for="vial_5">5 mg</label>
                    
                    <input type="radio" id="vial_10" name="vial_quantity" value="10">
                    <label for="vial_10">10 mg</label>
                    
                    <input type="radio" id="vial_15" name="vial_quantity" value="15">
                    <label for="vial_15">15 mg</label>
                    
                    <div class="other-input-wrapper">
                        <input type="radio" id="vial_other_radio" name="vial_quantity" value="other">
                        <label for="vial_other_radio">Other</label>
                        <input type="number" id="vial_other_input" class="other-input" min="0" step="any" disabled>
                    </div>
                </div>
            </fieldset>

            <fieldset class="form-group">
                <legend>
                    <img src="https://i.imgur.com/3KkcYhC.png" alt="water vial icon" class="icon">
                    How much bacteriostatic water are you adding?
                </legend>
                <div class="option-group">
                    <input type="radio" id="water_1" name="water_quantity" value="1" checked>
                    <label for="water_1">1 ml</label>

                    <input type="radio" id="water_2" name="water_quantity" value="2">
                    <label for="water_2">2 ml</label>

                    <input type="radio" id="water_3" name="water_quantity" value="3">
                    <label for="water_3">3 ml</label>

                    <input type="radio" id="water_5" name="water_quantity" value="5">
                    <label for="water_5">5 ml</label>
                    
                    <div class="other-input-wrapper">
                        <input type="radio" id="water_other_radio" name="water_quantity" value="other">
                        <label for="water_other_radio">Other</label>
                        <input type="number" id="water_other_input" class="other-input" min="0" step="any" disabled>
                    </div>
                </div>
            </fieldset>

            <fieldset class="form-group full-width">
                <legend>How much of the Peptide do you want in each dose?</legend>
                <div class="option-group">
                    <input type="radio" id="dose_50" name="dose_quantity" value="50" checked>
                    <label for="dose_50">50 mcg</label>

                    <input type="radio" id="dose_100" name="dose_quantity" value="100">
                    <label for="dose_100">100 mcg</label>

                    <input type="radio" id="dose_250" name="dose_quantity" value="250">
                    <label for="dose_250">250 mcg</label>

                    <input type="radio" id="dose_500" name="dose_quantity" value="500">
                    <label for="dose_500">500 mcg</label>
                    
                    <div class="other-input-wrapper">
                        <input type="radio" id="dose_other_radio" name="dose_quantity" value="other">
                        <label for="dose_other_radio">Other</label>
                        <input type="number" id="dose_other_input" class="other-input" min="0" step="any" disabled>
                    </div>
                </div>
            </fieldset>
        </form>

        <div class="calculator-result">
            <div class="result-text">
                To have a dose of <span id="resultDose">50</span> mcg pull the syringe to <span id="resultUnits">1</span>
            </div>
            <div class="ruler-container">
                <div class="ruler">
                    <div class="ruler-progress" id="rulerProgress"></div>
                </div>
                <div class="ruler-ticks" id="rulerTicks">
                    </div>
            </div>
        </div>
    </div>

    <script>
        // The JavaScript from the previous response remains unchanged as it is already correct.
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('peptideForm');
            
            // Result elements
            const resultDoseEl = document.getElementById('resultDose');
            const resultUnitsEl = document.getElementById('resultUnits');
            const rulerProgress = document.getElementById('rulerProgress');
            const rulerTicks = document.getElementById('rulerTicks');

            // --- Helper function to get value from a radio group ---
            function getRadioValue(groupName, otherInputId) {
                const checkedRadio = form.querySelector(`input[name="${groupName}"]:checked`);
                if (!checkedRadio) return 0;
                
                if (checkedRadio.value === 'other') {
                    const otherInput = document.getElementById(otherInputId);
                    return parseFloat(otherInput.value) || 0;
                }
                return parseFloat(checkedRadio.value);
            }

            // --- Helper function to update ruler ticks ---
            function updateRuler(syringeVol, units) {
                let maxUnits = 30; // Default for 0.3ml
                let tickIncrements = [0, 5, 10, 15, 20, 25, 30];

                if (syringeVol === 0.5) {
                    maxUnits = 50;
                    tickIncrements = [0, 10, 20, 30, 40, 50];
                } else if (syringeVol === 1.0) {
                    maxUnits = 100;
                    tickIncrements = [0, 20, 40, 60, 80, 100];
                }

                // Update ticks
                rulerTicks.innerHTML = tickIncrements.map(tick => `<span>${tick}</span>`).join('');

                // Update progress bar
                let percentage = (units / maxUnits) * 100;
                if (percentage > 100) percentage = 100;
                if (percentage < 0) percentage = 0;
                
                rulerProgress.style.width = percentage + '%';
            }

            // --- Main Calculation Function ---
            function calculate() {
                // 1. Get all input values
                const syringeVol = getRadioValue('syringe_volume');
                const vial_mg = getRadioValue('vial_quantity', 'vial_other_input');
                const water_ml = getRadioValue('water_quantity', 'water_other_input');
                const dose_mcg = getRadioValue('dose_quantity', 'dose_other_input');

                // 2. Perform calculation
                // Formula: units = (dose_mcg * water_ml) / (vial_mg * 10)
                let units = 0;
                if (vial_mg > 0 && water_ml > 0 && dose_mcg > 0) {
                    units = (dose_mcg * water_ml) / (vial_mg * 10);
                }

                // 3. Update the result text
                resultDoseEl.textContent = dose_mcg.toLocaleString();
                resultUnitsEl.textContent = units.toFixed(1).replace(/\.0$/, ''); // Show 1.5, but 1 (not 1.0)

                // 4. Update the ruler
                updateRuler(syringeVol, units);
            }

            // --- Event Listeners for "Other" fields ---
            function setupOtherInputs(radioId, inputId, groupName) {
                const radio = document.getElementById(radioId);
                const input = document.getElementById(inputId);
                
                radio.addEventListener('click', () => {
                    input.disabled = false;
                    input.focus();
                });
                
                form.querySelectorAll(`input[name="${groupName}"]:not(#${radioId})`).forEach(r => {
                    r.addEventListener('click', () => {
                        input.disabled = true;
                        input.value = '';
                    });
                });
            }

            setupOtherInputs('vial_other_radio', 'vial_other_input', 'vial_quantity');
            setupOtherInputs('water_other_radio', 'water_other_input', 'water_quantity');
            setupOtherInputs('dose_other_radio', 'dose_other_input', 'dose_quantity');

            // --- Listen for any change on the form ---
            form.addEventListener('input', calculate);

            // --- Initial calculation on load ---
            calculate();
        });
    </script>

</body>
</html>